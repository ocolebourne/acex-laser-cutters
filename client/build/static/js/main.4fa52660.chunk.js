(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{51:function(e,t,a){},64:function(e,t,a){},71:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(19),r=a.n(s),i=(a(51),a(6)),o=(a.p,a(64),a(57)),l=a(7),d=a(80),j=a(74),b=a(78),u=a(75),O=a(56),h=a(1);var x=function(e){return Object(h.jsxs)("div",{children:[Object(h.jsx)(d.a,{bg:"light",children:Object(h.jsxs)(j.a,{children:[Object(h.jsx)(d.a.Brand,{href:"",children:"AceX Admin"}),Object(h.jsx)(b.a.Link,{href:"#link",children:"Logout"})]})}),Object(h.jsxs)(j.a,{children:[Object(h.jsx)("h1",{children:"Welcome"}),Object(h.jsx)(u.a,{children:Object(h.jsx)(O.a,{})})]})]})},m=a(2),f=a(81),p=a(79),g=a(76),v=a(77);function y(e){var t=c.a.useState(!1),a=Object(i.a)(t,2),n=a[0],s=(a[1],c.a.useState(!1)),r=Object(i.a)(s,2);r[0],r[1],c.a.useRef(),c.a.useRef();return Object(h.jsxs)(f.a,Object(m.a)(Object(m.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(h.jsx)(f.a.Header,{closeButton:!0,children:Object(h.jsx)(f.a.Title,{id:"contained-modal-title-vcenter",children:"Add User"})}),Object(h.jsx)(f.a.Body,{children:Object(h.jsxs)(p.a.Group,{className:"mb-3",children:[Object(h.jsx)(p.a.Label,{children:"Short code"}),Object(h.jsx)(p.a.Control,{type:"text",placeholder:"e.g. ab1234",readOnly:!!n})]})}),Object(h.jsxs)(f.a.Footer,{children:[Object(h.jsx)(g.a,{variant:"primary",type:"submit",children:"Change Password"}),Object(h.jsx)(g.a,{variant:"secondary",onClick:e.onHide,children:"Cancel"})]})]}))}function S(e){var t=c.a.useState(!1),a=Object(i.a)(t,2),n=a[0],s=a[1],r=c.a.useState(!1),o=Object(i.a)(r,2),l=o[0],d=o[1],j=c.a.useState(!1),b=Object(i.a)(j,2),u=b[0],O=b[1],x=c.a.useState(!1),g=Object(i.a)(x,2),v=g[0],y=g[1],S=c.a.useState(!1),k=Object(i.a)(S,2),C=k[0],N=k[1],I=c.a.useRef(),B=c.a.useRef(),F=function(e){y(!1),N(!1),O(!1),"Enter"===e.key&&P()};function P(){s(!0);var t=I.current.value,a=B.current.value,n={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(sessionStorage.getItem("token"))},body:JSON.stringify({old_password:t,new_password:a})};fetch("/api/changepass",n).then((function(t){if(t.ok)d(!1),y(!0),setTimeout((function(){e.onHide(),s(!1),y(!1)}),2e3);else{if(401==t.status)throw console.log("Incorrect old password"),O(!0),new Error(t.statusText);if(403==t.status)throw console.log("Auth token bad"),e.kick(),new Error(t.statusText)}})).catch((function(e){console.log(e),s(!1),d(!1),N(!0)}))}return Object(h.jsxs)(f.a,Object(m.a)(Object(m.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(h.jsx)(f.a.Header,{closeButton:!0,children:Object(h.jsx)(f.a.Title,{id:"contained-modal-title-vcenter",children:"Change Admin Password"})}),Object(h.jsx)(f.a.Body,{children:Object(h.jsxs)(p.a,{children:[Object(h.jsxs)(p.a.Group,{className:"mb-3",children:[Object(h.jsx)(p.a.Label,{children:"Old password"}),Object(h.jsx)(p.a.Control,{type:"password",placeholder:"",readOnly:!!n,ref:I,isInvalid:u,isValid:v,onKeyPress:F}),Object(h.jsx)(p.a.Control.Feedback,{type:"invalid",children:"Incorrect old password, try again"})]}),Object(h.jsxs)(p.a.Group,{className:"mb-3",children:[Object(h.jsx)(p.a.Label,{children:"New password"}),Object(h.jsx)(p.a.Control,{type:"password",placeholder:"",readOnly:!!n,ref:B,onKeyPress:F,isValid:v})]})]})}),Object(h.jsx)(w,{loadingSpinner:l,showErrorMessage:C,showSuccessMessage:v,readOnly:n,onSubmit:P,onHide:e.onHide,cancel:"Cancel",actionButton:"Change Password"})]}))}function k(e){var t=c.a.useState(!1),a=Object(i.a)(t,2),n=a[0],s=a[1],r=c.a.useState(""),o=Object(i.a)(r,2),l=o[0],d=o[1],j=c.a.useState(!1),b=Object(i.a)(j,2),x=b[0],v=b[1],y=c.a.useState(!1),S=Object(i.a)(y,2),k=S[0],C=S[1],N=c.a.useState(!1),I=Object(i.a)(N,2),B=I[0],F=I[1],P=c.a.useState(!1),T=Object(i.a)(P,2),A=T[0],E=T[1],H=c.a.useState(!1),L=Object(i.a)(H,2),M=L[0],R=L[1],G=c.a.useState(!1),z=Object(i.a)(G,2),D=z[0],J=z[1],K=c.a.useRef(),U=c.a.useRef(),_=function(e){if(F(!1),E(!1),R(!1),J(!1),"Enter"===e.key)if(x){if(e.preventDefault(),console.log(K.current.value),10===K.current.value.length){console.log("here");var t=K.current.value;d(t)}}else V(),n(!0)};function V(){var t=U.current.value,a=K.current.value;if(t)if(a){s(!0);var n={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(sessionStorage.getItem("token"))},body:JSON.stringify({short_code:t,card_id:a})};fetch("/api/addUser",n).then((function(t){if(t.ok)C(!1),F(!0),setTimeout((function(){e.onHide(),s(!1),F(!1),d("")}),2e3);else if(403==t.status)throw console.log("Auth token bad"),e.kick(),new Error(t.statusText)})).catch((function(e){console.log(e),s(!1),C(!1),E(!0)}))}else J(!0);else R(!0)}return c.a.useEffect((function(){x&&(K.current.value="",K.current.focus())}),[x]),Object(h.jsxs)(f.a,Object(m.a)(Object(m.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(h.jsx)("input",{className:"scanner-input",ref:K,onKeyPress:_,onBlur:function(){return v(!1)}}),Object(h.jsx)(f.a.Header,{closeButton:!0,children:Object(h.jsx)(f.a.Title,{id:"contained-modal-title-vcenter",children:"Add User"})}),Object(h.jsxs)(f.a.Body,{children:[Object(h.jsxs)(p.a.Group,{className:"mb-3",children:[Object(h.jsx)(p.a.Label,{children:"Short code"}),Object(h.jsx)(p.a.Control,{type:"text",placeholder:"e.g. ab1234",readOnly:!!n,onKeyPress:_,ref:U,isInvalid:M}),Object(h.jsx)(p.a.Control.Feedback,{type:"invalid",children:"Please enter a short code."})]}),Object(h.jsxs)(p.a.Group,{className:"mb-3",children:[Object(h.jsx)(p.a.Label,{children:"Card ID"}),Object(h.jsxs)(u.a,{children:[Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)(g.a,{className:"scanner-button",onClick:function(){return v(!0)},variant:"primary",disabled:!(!x&&!n),children:x?"Scan card":"Enable Scanner"})}),Object(h.jsxs)(O.a,{children:[Object(h.jsx)(p.a.Control,{type:"password",placeholder:"",value:l,readOnly:!0,isInvalid:D}),Object(h.jsx)(p.a.Control.Feedback,{type:"invalid",children:"Please add a card ID."})]})]})]})]}),Object(h.jsx)(w,{loadingSpinner:k,showErrorMessage:A,showSuccessMessage:B,readOnly:n,onSubmit:V,onHide:e.onHide,cancel:"Cancel",actionButton:"Add User"})]}))}function w(e){return Object(h.jsxs)(f.a.Footer,{children:[e.loadingSpinner?Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)(v.a,{className:"mra",animation:"border"})}):Object(h.jsx)(h.Fragment,{}),e.showSuccessMessage?Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)("div",{className:"mra success-message",children:"Success"})}):Object(h.jsx)(h.Fragment,{}),e.showErrorMessage?Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)("div",{className:"mra error-message",children:"Error"})}):Object(h.jsx)(h.Fragment,{}),Object(h.jsx)(g.a,{variant:"secondary",onClick:e.onHide,className:"mla",children:e.cancel}),Object(h.jsx)(g.a,{variant:"primary",type:"submit",onClick:function(){return e.onSubmit()},disabled:!!e.readOnly,children:e.actionButton})]})}var C=function(e){var t=c.a.useState(!1),a=Object(i.a)(t,2),n=a[0],s=a[1],r=c.a.useState(!1),o=Object(i.a)(r,2),l=o[0],x=o[1],m=c.a.useState(!1),f=Object(i.a)(m,2),w=f[0],C=f[1],N=c.a.useState(!1),I=Object(i.a)(N,2),B=I[0],F=I[1],P=c.a.useState(!1),T=Object(i.a)(P,2),A=T[0],E=T[1],H=c.a.useState(!1),L=Object(i.a)(H,2),M=L[0],R=L[1],G=c.a.useState(""),z=Object(i.a)(G,2),D=z[0],J=z[1],K=c.a.useState(!1),U=Object(i.a)(K,2),_=U[0],V=U[1],W=c.a.useState(!1),X=Object(i.a)(W,2),q=X[0],Q=X[1],Y=c.a.useRef();function Z(){var e=Y.current.value;V(!0),E(!0);var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e})};fetch("/api/login",t).then((function(e){return e.json()})).then((function(e){V(!1),sessionStorage.setItem("token",e.token),E(!1),F(!0)})).catch((function(e){console.log(e),V(!1),E(!1),R(!0),J("Incorrect password, try again")}))}function $(){sessionStorage.removeItem("token"),F(!1),Q(!0)}return c.a.useEffect((function(){sessionStorage.getItem("token")&&F(!0)}),[]),Object(h.jsxs)("div",{children:[Object(h.jsx)(d.a,{bg:"light",children:Object(h.jsxs)(j.a,{children:[Object(h.jsx)(d.a.Brand,{href:"",children:"AceX Admin"}),B?Object(h.jsx)(b.a.Link,{onClick:function(){return sessionStorage.removeItem("token"),void F(!1)},children:"Logout"}):Object(h.jsx)(h.Fragment,{})]})}),B?Object(h.jsxs)(j.a,{children:[Object(h.jsx)("h1",{children:"Welcome"}),Object(h.jsxs)(u.a,{className:"justify-content-md-left mt50",children:[Object(h.jsx)(O.a,{xs:6,md:4,xl:3,children:Object(h.jsx)("div",{onClick:function(){return s(!0)},className:"admin-card",children:Object(h.jsx)("h2",{className:"mta",children:"Add user"})})}),Object(h.jsx)(O.a,{xs:6,md:4,xl:3,children:Object(h.jsx)("div",{onClick:function(){return x(!0)},className:"admin-card",children:Object(h.jsx)("h2",{className:"mta",children:"Delete user"})})}),Object(h.jsx)(O.a,{xs:6,md:4,xl:3,children:Object(h.jsx)("div",{onClick:function(){return C(!0)},className:"admin-card",children:Object(h.jsx)("h2",{className:"mta",children:"Change password"})})})]}),Object(h.jsx)(k,{show:n,onHide:function(){return s(!1)},kick:function(){return $()}}),Object(h.jsx)(y,{show:l,onHide:function(){return x(!1)},kick:function(){return $()}}),Object(h.jsx)(S,{show:w,onHide:function(){return C(!1)},kick:function(){return $()}})]}):Object(h.jsxs)(j.a,{children:[Object(h.jsx)("h1",{children:"Please enter the admin password"}),Object(h.jsxs)(p.a.Group,{className:"mt50 mb-3",children:[q?Object(h.jsx)("div",{className:"mb10 error-message",children:"Session expired, please log in again"}):Object(h.jsx)(h.Fragment,{children:" "}),Object(h.jsxs)(u.a,{children:[Object(h.jsxs)(O.a,{xs:"9",md:"4",children:[Object(h.jsx)(p.a.Control,{type:"password",placeholder:"",readOnly:!!A,ref:Y,onKeyPress:function(e){R(!1),"Enter"===e.key&&Z()},isInvalid:M}),Object(h.jsx)(p.a.Control.Feedback,{type:"invalid",children:D})]}),Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)(g.a,{onClick:function(){return Z()},type:"submit",disabled:!!A,children:"Login"})}),_?Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)(v.a,{animation:"border"})}):Object(h.jsx)(h.Fragment,{})]})]})]})]})};var N=function(){var e=c.a.useState(null),t=Object(i.a)(e,2);return t[0],t[1],Object(h.jsx)(o.a,{className:"App",children:Object(h.jsxs)(l.c,{children:[Object(h.jsx)(l.a,{path:"/admin",element:Object(h.jsx)(C,{})}),Object(h.jsx)(l.a,{path:"/",element:Object(h.jsx)(x,{})})]})})},I=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,82)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;a(e),n(e),c(e),s(e),r(e)}))};r.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(N,{})}),document.getElementById("root")),I()}},[[71,1,2]]]);
//# sourceMappingURL=main.4fa52660.chunk.js.map