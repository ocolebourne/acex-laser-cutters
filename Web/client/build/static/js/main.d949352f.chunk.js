(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{51:function(e,t,a){},64:function(e,t,a){},71:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(19),r=a.n(s),o=(a(51),a(5)),i=(a.p,a(64),a(57)),l=a(7),d=a(80),j=a(74),u=a(78),b=a(75),O=a(56),h=a(1);var x=function(e){return Object(h.jsxs)("div",{children:[Object(h.jsx)(d.a,{bg:"light",children:Object(h.jsxs)(j.a,{children:[Object(h.jsx)(d.a.Brand,{href:"",children:"AceX Admin"}),Object(h.jsx)(u.a.Link,{href:"#link",children:"Logout"})]})}),Object(h.jsxs)(j.a,{children:[Object(h.jsx)("h1",{children:"Welcome"}),Object(h.jsx)(b.a,{children:Object(h.jsx)(O.a,{})})]})]})},f=a(2),m=a(81),p=a(79),g=a(76),v=a(77);function S(e){var t=c.a.useState(!1),a=Object(o.a)(t,2),n=a[0],s=a[1],r=c.a.useState(""),i=Object(o.a)(r,2),l=i[0],d=i[1],j=c.a.useState(!1),u=Object(o.a)(j,2),x=u[0],v=u[1],S=c.a.useState(!1),y=Object(o.a)(S,2),k=y[0],C=y[1],N=c.a.useState(!1),B=Object(o.a)(N,2),I=B[0],T=B[1],E=c.a.useState(!1),P=Object(o.a)(E,2),F=P[0],H=P[1],A=c.a.useState(!1),L=Object(o.a)(A,2),R=L[0],D=L[1],M=c.a.useState(!1),U=Object(o.a)(M,2),G=U[0],J=U[1],K=c.a.useState(""),z=Object(o.a)(K,2),_=z[0],V=z[1],W=c.a.useRef(),X=c.a.useRef(),q=function(e){if(Q(),"Enter"===e.key)if(x){if(e.preventDefault(),console.log(W.current.value),10===W.current.value.length){console.log("here");var t=W.current.value;d(t)}}else Y(),n(!0)};function Q(){T(!1),H(!1),D(!1),J(!1),s(!1)}function Y(){var t=X.current.value,a=W.current.value;if(t||a){s(!0);var n={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(sessionStorage.getItem("token"))}};a?n.body=JSON.stringify({card_id:a}):t&&(n.body=JSON.stringify({short_code:t})),fetch("/api/delUser",n).then((function(n){if(n.ok)C(!1),T(!0),setTimeout((function(){e.onHide(),Q(),d("")}),2e3);else{if(403===n.status)throw console.log("Auth token bad"),Q(),d(""),e.kick(),new Error(n.statusText);if(404===n.status)throw console.log("User not found"),V("User not found, try again"),d(""),a?J(!0):t&&D(!0),new Error(n.statusText)}})).catch((function(e){console.log(e),s(!1),C(!1),H(!0)}))}else V("Please enter valid user details"),D(!0),J(!0)}return c.a.useEffect((function(){x&&(W.current.value="",W.current.focus(),T(!1),H(!1),D(!1),J(!1),d(""))}),[x]),Object(h.jsxs)(m.a,Object(f.a)(Object(f.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(h.jsx)("input",{className:"scanner-input",ref:W,onKeyPress:q,onBlur:function(){return v(!1)}}),Object(h.jsx)(m.a.Header,{closeButton:!0,children:Object(h.jsx)(m.a.Title,{id:"contained-modal-title-vcenter",children:"Delete User"})}),Object(h.jsxs)(m.a.Body,{children:[Object(h.jsxs)(p.a.Group,{className:"mb-3",children:[Object(h.jsx)(p.a.Label,{children:"Short code"}),Object(h.jsx)(p.a.Control,{type:"text",placeholder:"e.g. ab1234",readOnly:!!n,onKeyPress:q,ref:X,isInvalid:R}),Object(h.jsx)(p.a.Control.Feedback,{type:"invalid",children:_})]}),Object(h.jsx)("h5",{className:"mb20",children:"OR"}),Object(h.jsxs)(p.a.Group,{className:"mb-3",children:[Object(h.jsx)(p.a.Label,{children:"Card ID"}),Object(h.jsxs)(b.a,{children:[Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)(g.a,{className:"scanner-button",onClick:function(){return v(!0)},variant:"primary",disabled:!(!x&&!n),children:x?"Scan card":"Enable Scanner"})}),Object(h.jsxs)(O.a,{children:[Object(h.jsx)(p.a.Control,{type:"password",placeholder:"",value:l,readOnly:!0,isInvalid:G}),Object(h.jsx)(p.a.Control.Feedback,{type:"invalid",children:_})]})]})]})]}),Object(h.jsx)(w,{loadingSpinner:k,showErrorMessage:F,showSuccessMessage:I,readOnly:n,onSubmit:Y,onHide:e.onHide,cancel:"Cancel",actionButton:"Delete User",actionButtonRed:!0})]}))}function y(e){var t=c.a.useState(!1),a=Object(o.a)(t,2),n=a[0],s=a[1],r=c.a.useState(!1),i=Object(o.a)(r,2),l=i[0],d=i[1],j=c.a.useState(!1),u=Object(o.a)(j,2),b=u[0],O=u[1],x=c.a.useState(!1),g=Object(o.a)(x,2),v=g[0],S=g[1],y=c.a.useState(!1),k=Object(o.a)(y,2),C=k[0],N=k[1],B=c.a.useRef(),I=c.a.useRef(),T=function(e){S(!1),N(!1),O(!1),"Enter"===e.key&&E()};function E(){s(!0);var t=B.current.value,a=I.current.value,n={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(sessionStorage.getItem("token"))},body:JSON.stringify({old_password:t,new_password:a})};fetch("/api/changepass",n).then((function(t){if(t.ok)d(!1),S(!0),setTimeout((function(){e.onHide(),s(!1),S(!1)}),2e3);else{if(401===t.status)throw console.log("Incorrect old password"),O(!0),new Error(t.statusText);if(403===t.status)throw console.log("Auth token bad"),e.kick(),new Error(t.statusText)}})).catch((function(e){console.log(e),s(!1),d(!1),N(!0)}))}return Object(h.jsxs)(m.a,Object(f.a)(Object(f.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(h.jsx)(m.a.Header,{closeButton:!0,children:Object(h.jsx)(m.a.Title,{id:"contained-modal-title-vcenter",children:"Change Admin Password"})}),Object(h.jsx)(m.a.Body,{children:Object(h.jsxs)(p.a,{children:[Object(h.jsxs)(p.a.Group,{className:"mb-3",children:[Object(h.jsx)(p.a.Label,{children:"Old password"}),Object(h.jsx)(p.a.Control,{type:"password",placeholder:"",readOnly:!!n,ref:B,isInvalid:b,isValid:v,onKeyPress:T}),Object(h.jsx)(p.a.Control.Feedback,{type:"invalid",children:"Incorrect old password, try again"})]}),Object(h.jsxs)(p.a.Group,{className:"mb-3",children:[Object(h.jsx)(p.a.Label,{children:"New password"}),Object(h.jsx)(p.a.Control,{type:"password",placeholder:"",readOnly:!!n,ref:I,onKeyPress:T,isValid:v})]})]})}),Object(h.jsx)(w,{loadingSpinner:l,showErrorMessage:C,showSuccessMessage:v,readOnly:n,onSubmit:E,onHide:e.onHide,cancel:"Cancel",actionButton:"Change Password"})]}))}function k(e){var t=c.a.useState(!1),a=Object(o.a)(t,2),n=a[0],s=a[1],r=c.a.useState(""),i=Object(o.a)(r,2),l=i[0],d=i[1],j=c.a.useState(!1),u=Object(o.a)(j,2),x=u[0],v=u[1],S=c.a.useState(!1),y=Object(o.a)(S,2),k=y[0],C=y[1],N=c.a.useState(!1),B=Object(o.a)(N,2),I=B[0],T=B[1],E=c.a.useState(!1),P=Object(o.a)(E,2),F=P[0],H=P[1],A=c.a.useState(!1),L=Object(o.a)(A,2),R=L[0],D=L[1],M=c.a.useState(!1),U=Object(o.a)(M,2),G=U[0],J=U[1],K=c.a.useRef(),z=c.a.useRef(),_=function(e){if(V(),"Enter"===e.key)if(x){if(e.preventDefault(),console.log(K.current.value),10===K.current.value.length){console.log("here");var t=K.current.value;d(t)}}else W(),n(!0)};function V(){T(!1),H(!1),D(!1),J(!1),s(!1)}function W(){var t=z.current.value,a=K.current.value;if(t)if(a){s(!0);var n={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(sessionStorage.getItem("token"))},body:JSON.stringify({short_code:t,card_id:a})};fetch("/api/addUser",n).then((function(t){if(t.ok)C(!1),T(!0),setTimeout((function(){e.onHide(),d(""),V()}),2e3);else if(403===t.status)throw console.log("Auth token bad"),e.kick(),new Error(t.statusText)})).catch((function(e){console.log(e),s(!1),C(!1),H(!0)}))}else J(!0);else D(!0)}return c.a.useEffect((function(){x&&(K.current.value="",K.current.focus(),V(),d(""))}),[x]),Object(h.jsxs)(m.a,Object(f.a)(Object(f.a)({},e),{},{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(h.jsx)("input",{className:"scanner-input",ref:K,onKeyPress:_,onBlur:function(){return v(!1)}}),Object(h.jsx)(m.a.Header,{closeButton:!0,children:Object(h.jsx)(m.a.Title,{id:"contained-modal-title-vcenter",children:"Add User"})}),Object(h.jsxs)(m.a.Body,{children:[Object(h.jsxs)(p.a.Group,{className:"mb-3",children:[Object(h.jsx)(p.a.Label,{children:"Short code"}),Object(h.jsx)(p.a.Control,{type:"text",placeholder:"e.g. ab1234",readOnly:!!n,onKeyPress:_,ref:z,isInvalid:R}),Object(h.jsx)(p.a.Control.Feedback,{type:"invalid",children:"Please enter a short code."})]}),Object(h.jsxs)(p.a.Group,{className:"mb-3",children:[Object(h.jsx)(p.a.Label,{children:"Card ID"}),Object(h.jsxs)(b.a,{children:[Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)(g.a,{className:"scanner-button",onClick:function(){return v(!0)},variant:"primary",disabled:!(!x&&!n),children:x?"Scan card":"Enable Scanner"})}),Object(h.jsxs)(O.a,{children:[Object(h.jsx)(p.a.Control,{type:"password",placeholder:"",value:l,readOnly:!0,isInvalid:G}),Object(h.jsx)(p.a.Control.Feedback,{type:"invalid",children:"Please add a card ID."})]})]})]})]}),Object(h.jsx)(w,{loadingSpinner:k,showErrorMessage:F,showSuccessMessage:I,readOnly:n,onSubmit:W,onHide:e.onHide,cancel:"Cancel",actionButton:"Add User"})]}))}function w(e){return Object(h.jsxs)(m.a.Footer,{children:[e.loadingSpinner?Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)(v.a,{className:"mra",animation:"border"})}):Object(h.jsx)(h.Fragment,{}),e.showSuccessMessage?Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)("div",{className:"mra success-message",children:"Success"})}):Object(h.jsx)(h.Fragment,{}),e.showErrorMessage?Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)("div",{className:"mra error-message",children:"Error"})}):Object(h.jsx)(h.Fragment,{}),Object(h.jsx)(g.a,{variant:"secondary",onClick:e.onHide,className:"mla",children:e.cancel}),Object(h.jsx)(g.a,{variant:e.actionButtonRed?"danger":"primary",type:"submit",onClick:function(){return e.onSubmit()},disabled:!!e.readOnly,children:e.actionButton})]})}var C=function(e){var t=c.a.useState(!1),a=Object(o.a)(t,2),n=a[0],s=a[1],r=c.a.useState(!1),i=Object(o.a)(r,2),l=i[0],x=i[1],f=c.a.useState(!1),m=Object(o.a)(f,2),w=m[0],C=m[1],N=c.a.useState(!1),B=Object(o.a)(N,2),I=(B[0],B[1],c.a.useState(!0)),T=Object(o.a)(I,2),E=T[0],P=T[1],F=c.a.useState(!1),H=Object(o.a)(F,2),A=H[0],L=H[1],R=c.a.useState(!1),D=Object(o.a)(R,2),M=D[0],U=D[1],G=c.a.useState(""),J=Object(o.a)(G,2),K=J[0],z=J[1],_=c.a.useState(!1),V=Object(o.a)(_,2),W=V[0],X=V[1],q=c.a.useState(!1),Q=Object(o.a)(q,2),Y=Q[0],Z=Q[1],$=c.a.useRef();function ee(){var e=$.current.value;X(!0),L(!0);var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e})};fetch("/api/login",t).then((function(e){return e.json()})).then((function(e){X(!1),sessionStorage.setItem("token",e.token),L(!1),P(!0)})).catch((function(e){console.log(e),X(!1),L(!1),U(!0),z("Incorrect password, try again")}))}function te(){sessionStorage.removeItem("token"),P(!1),Z(!0)}return c.a.useEffect((function(){sessionStorage.getItem("token")&&P(!0)}),[]),Object(h.jsxs)("div",{children:[Object(h.jsx)(d.a,{bg:"light",children:Object(h.jsxs)(j.a,{children:[Object(h.jsx)(d.a.Brand,{href:"",children:"AceX Admin"}),E?Object(h.jsx)(u.a.Link,{onClick:function(){return sessionStorage.removeItem("token"),void P(!1)},children:"Logout"}):Object(h.jsx)(h.Fragment,{})]})}),E?Object(h.jsxs)(j.a,{children:[Object(h.jsx)("h1",{children:"Welcome"}),Object(h.jsxs)(b.a,{className:"justify-content-md-left mt50",children:[Object(h.jsx)(O.a,{xs:6,md:4,xl:3,children:Object(h.jsx)("div",{onClick:function(){return s(!0)},className:"admin-card",children:Object(h.jsx)("h2",{className:"mta",children:"Add user"})})}),Object(h.jsx)(O.a,{xs:6,md:4,xl:3,children:Object(h.jsx)("div",{onClick:function(){return x(!0)},className:"admin-card",children:Object(h.jsx)("h2",{className:"mta",children:"Delete user"})})}),Object(h.jsx)(O.a,{xs:6,md:4,xl:3,children:Object(h.jsx)("div",{onClick:function(){return C(!0)},className:"admin-card",children:Object(h.jsx)("h2",{className:"mta",children:"Change password"})})})]}),Object(h.jsx)(k,{show:n,onHide:function(){return s(!1)},kick:function(){return te()}}),Object(h.jsx)(S,{show:l,onHide:function(){return x(!1)},kick:function(){return te()}}),Object(h.jsx)(y,{show:w,onHide:function(){return C(!1)},kick:function(){return te()}})]}):Object(h.jsxs)(j.a,{children:[Object(h.jsx)("h1",{children:"Please enter the admin password"}),Object(h.jsxs)(p.a.Group,{className:"mt50 mb-3",children:[Y?Object(h.jsx)("div",{className:"mb10 error-message",children:"Session expired, please log in again"}):Object(h.jsx)(h.Fragment,{children:" "}),Object(h.jsxs)(b.a,{children:[Object(h.jsxs)(O.a,{xs:"9",md:"4",children:[Object(h.jsx)(p.a.Control,{type:"password",placeholder:"",readOnly:!!A,ref:$,onKeyPress:function(e){U(!1),"Enter"===e.key&&ee()},isInvalid:M}),Object(h.jsx)(p.a.Control.Feedback,{type:"invalid",children:K})]}),Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)(g.a,{onClick:function(){return ee()},type:"submit",disabled:!!A,children:"Login"})}),W?Object(h.jsx)(O.a,{xs:"auto",children:Object(h.jsx)(v.a,{animation:"border"})}):Object(h.jsx)(h.Fragment,{})]})]})]})]})};var N=function(){var e=c.a.useState(null),t=Object(o.a)(e,2);return t[0],t[1],Object(h.jsx)(i.a,{className:"App",children:Object(h.jsxs)(l.c,{children:[Object(h.jsx)(l.a,{path:"/admin",element:Object(h.jsx)(C,{})}),Object(h.jsx)(l.a,{path:"/",element:Object(h.jsx)(x,{})})]})})},B=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,82)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;a(e),n(e),c(e),s(e),r(e)}))};r.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(N,{})}),document.getElementById("root")),B()}},[[71,1,2]]]);
//# sourceMappingURL=main.d949352f.chunk.js.map